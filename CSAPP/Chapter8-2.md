### Chapter 8 异常控制流

#### 进程

- 进程的抽象
  - 一个独立的逻辑控制流，它提供一个假象，好像我们的程序独占地使用处理器。
  - 一个私有的地址空间，它提供一个假象，好像我们的程序独占地使用内存系统。
- 逻辑控制流：
- 并发流：一个逻辑流的执行在时间上与另一个流重叠。一个流重叠，称为并发流(concurrentflow),这两个流被称为并发地运行。更准确地说，流X和Y互相并发，当且仅当X在Y开始之后和Y结束之前开始，或者Y在X开始之后和X结束之前开始。
- 私有地址空间
- 用户模式和内核模式
- 上下文切换
  - 调度：在进程执行的某些时刻，内核可以决定抢占当前进程，并重新开始一个先前被强占了的进程。

**进程控制**

进程总是处于下面三种状态之一

- 运行

  进程要么在CPU上执行，要么在等待被执行且最终会被内核调度。

- 停止

  进程的执行被挂起(suspended), 且不会被调度。当收到SIGSTOP、SIGTSTP、SIGTTIN或者SIGTTOU信号时，进程就停止，并且保持停止直到它收到个SIGCONT信号，在这个时刻，进程再次开始运行。

- 终止

  进程永远地停止了。进程会因为三种原因终止：

  1. 收到一个信号，该信号的默认行为是终止进程；
  2. 从主程序返回；
  3. 调用exit函数。

**回收子进程**

- 子进程终止后，等待父进程回收。
- 僵死进程：终止但还未回收的进程。
- init进程是所有进程的祖先。

**几个函数**

- fork:父进程通过它创建一个新的运行的子进程。
- waitpid:调用它来等待它的子进程终止或者停止
- sleep函数将一个进程挂起一段指定的时间。
- execve函数在当前进程的上下文中 加载并运行一个新程序。

#### 信号

​		一个信号就是一条小消息，它通知进程系统中发生了一个某种类型的事件。

**信号术语**:

1. 发送信号
   * 进程组：每个进程都只属于一个进程组
   * /bin/kill 命令
   * 从键盘发送信号
   * 用kill函数发送信号
   * 用alarm函数发送信号

2. 接收信号
   * 每个信号都有一个预定义的默认行为：进程终止、进程终止并转储内存、进程停止（挂起）直到被SIGCONT信号重启、进程忽略该信号

#### 非本地跳转

​	用户级的异常控制流的形式

#### 操作进程的工具

- STRACE: 打印一个正在运行的程序和它的子进程调用的每个系统调用的轨迹。 对于好奇的学生而言，这是一个令人着迷的工具。用-static编译你的程序，能得到一个更干净的、不带有大量与共享库相关的输出的轨迹。
- PS: 列出当前系统中的进程（包括僵死进程）。
- TOP: 打印出关千当前进程资源使用的信息。
- PMAP: 显示进程的内存映射。
- /proc: 一个虚拟文件系统， 以ASCII文本格式输出大量内核数据结构的内容， 用户程序可以读取这些内容。 比如， 输入 "ca/proc/loadavg", 可以看到你的Linux系统上 当前的平均负载。